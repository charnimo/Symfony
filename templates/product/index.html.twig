{# templates/product/index.html.twig #}
{% extends 'base.html.twig' %}

{% block title %}Hello ProductController!{% endblock %}

{% block body %}
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ENjdO4Dr2bkBIFxQpeoTz1HIcje39Wm4jDKdf19U8gI4ddQ3GYNS7NTKfAdVQSZe" crossorigin="anonymous"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            margin: 0;
            padding: 0;
            background-repeat: no-repeat;
            background-position: center bottom;
            background-size: cover;
        }

        /* Sidebar */
        #sidebar {
            background-color: black;
            padding-top: 70px;
            height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            width: 250px;
            overflow-y: auto;
        }

        .main {
            margin-left: 264px;
        }

        .content {
            padding: 20px;
            background-color: #f0f0f0;
        }

        .sidebar-logo {
            padding: 1.15rem 1.5rem;
        }

        .sidebar-logo a {
            color: #e9ecef;
            font-size: 1.25rem;
            font-weight: 600;
        }

        .sidebar-nav {
            padding: 0;
        }

        .sidebar-header {
            color: #e9ecef;
            font-size: .75rem;
            padding: 1.5rem 1.5rem .375rem;
        }

        a.sidebar-link {
            padding: .625rem 1.625rem;
            color: #e9ecef;
            position: relative;
            display: block;
            font-size: 1rem;
            text-decoration: none;
        }

        .sidebar-link[data-bs-toggle="collapse"]::after {
            border: solid;
            border-width: 0 .075rem .075rem 0;
            content: "";
            display: inline-block;
            padding: 2px;
            position: absolute;
            right: 1.5rem;
            top: 1.4rem;
            transform: rotate(-135deg);
            transition: all .2s ease-out;
        }

        .sidebar-link[data-bs-toggle="collapse"].collapsed::after {
            transform: rotate(45deg);
            transition: all .2s ease-out;
        }

        .product-image {
            max-width: 100%;
            max-height: 200px;
        }

        .col-divider {
            border-right: 1px solid #ccc;
        }
    </style>

    <main>
        <div class="wrapper expanded">
            <!-- Sidebar -->
            <aside id="sidebar">
                <div class="h-100">
                    <!-- Sidebar Navigation -->
                    <ul class="sidebar-nav">
                        <br><br><br>
                        <li class="sidebar-header">Filter</li>
                        <li class="sidebar-item">
                            <a href="#" class="sidebar-link collapsed" data-bs-toggle="collapse" data-bs-target="#categories" aria-expanded="false" aria-controls="categories">
                                <i class="fa-regular fa-file-lines pe-2"></i>
                                Categories
                            </a>
                            <ul id="categories" class="sidebar-dropdown list-unstyled collapse" data-bs-parent="#sidebar">
                                <li class="sidebar-item"><a href="#" class="sidebar-link filter-category" data-category="All">ALL</a></li>
                                <li class="sidebar-item"><a href="#" class="sidebar-link filter-category" data-category="pc">PC</a></li>
                                <li class="sidebar-item"><a href="#" class="sidebar-link filter-category" data-category="console">Console</a></li>
                                <li class="sidebar-item"><a href="#" class="sidebar-link filter-category" data-category="tv">TV</a></li>
                                <li class="sidebar-item"><a href="#" class="sidebar-link filter-category" data-category="electromenager">Electroménager</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </aside>
            <!-- End of Sidebar -->

            <!-- Page Content -->
            <section class="main">
                <div class="content">
                    <div class="mt-5">
                        <!-- Affichage des produits -->
                        <div class="album py-5 bg-body-tertiary">
                            <div class="container" id="produitsContainer">
                                <div class="row row-cols-1 row-cols-sm-2 row-cols-md-3 g-3" id="produitsRow">
                                    {% for produit in produits %}
                                        <div class="col" data-categorie="{{ produit.category }}" data-prix="{{ produit.price }}">
                                            <div class="card shadow-lg h-100 rounded-4">
                                                <div class="card-body d-flex flex-column justify-content-between">
                                                    <div style="text-align: center;">
                                                        <h5 class="card-title" style="font-family: 'Times New Roman', Times, serif; font-weight: bold;">{{ produit.name }}</h5>
                                                        <img src="{{ asset('images/' ~ produit.image) }}" class="img-fluid rounded" style="max-height: 150px;">
                                                    </div>
                                                    <p class="card-text">{{ produit.description[:100] }}...</p>
                                                    <div class="d-flex justify-content-start align-items-center mb-2">
                                                        <button type="button" class="btn btn-sm btn-primary me-2" data-bs-toggle="modal" data-bs-target="#descriptionModal{{ produit.id }}">
                                                            <i class="fas fa-eye"></i>
                                                        </button>
                                                        <!-- Bouton avec une icône de panier -->
                                                        <form method="POST" action="{{ path('add_to_cart') }}">
                                                            <input type="hidden" name="product_name" value="{{ produit.name }}">
                                                            <input type="hidden" name="product_price" value="{{ produit.price }}">
                                                            <input type="hidden" name="product_image" value="{{ produit.image }}">
                                                            <button type="submit" name="addtocart" class="btn btn-sm btn-success">
                                                                <i class="fas fa-shopping-cart"></i>
                                                            </button>
                                                        </form>
                                                    </div>
                                                    <small class="text-muted" style="font-weight: bold;">{{ produit.price }} TND</small>
                                                </div>
                                            </div>
                                        </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>

                        <!-- Modals pour afficher la description complète et modifier le produit -->
                        {% for produit in produits %}
                            <div class="modal fade" id="descriptionModal{{ produit.id }}" tabindex="-1" aria-labelledby="descriptionModalLabel{{ produit.id }}" aria-hidden="true">
                                <div class="modal-dialog modal-dialog-centered modal-lg">
                                    <div class="modal-content">
                                        <div class="modal-header">
                                            <h5 class="modal-title" id="descriptionModalLabel{{ produit.id }}">Description complète du produit</h5>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                                        </div>
                                        <div class="modal-body">
                                            <div class="row">
                                                <div class="col-md-6 col-divider">
                                                    <img src="{{ asset('images/' ~ produit.image) }}" class="img-fluid mb-3" alt="{{ produit.name }}">
                                                </div>
                                                <div class="col-md-6">
                                                    <p>{{ produit.description }}</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                </div>
            </section>
            <!-- End Page Content -->
        </div>
    </main>

    <!-- Vos scripts JavaScript -->
    <!-- Laissez vos liens vers les fichiers JS ici -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/js/all.min.js"></script>
    <script src="https://code.jquery

{% endblock %}
